<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>src/Numeric/LinearAlgebra.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE FlexibleContexts #-}</span>
<a name="line-2"></a>
<a name="line-3"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-4"></a><span class='hs-comment'>{- |
<a name="line-5"></a>Module      :  Numeric.LinearAlgebra
<a name="line-6"></a>Copyright   :  (c) Alberto Ruiz 2006-15
<a name="line-7"></a>License     :  BSD3
<a name="line-8"></a>Maintainer  :  Alberto Ruiz
<a name="line-9"></a>Stability   :  provisional
<a name="line-10"></a>
<a name="line-11"></a>
<a name="line-12"></a>-}</span>
<a name="line-13"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-14"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Numeric</span><span class='hs-varop'>.</span><span class='hs-conid'>LinearAlgebra</span> <span class='hs-layout'>(</span>
<a name="line-15"></a>
<a name="line-16"></a>    <span class='hs-comment'>-- * Basic types and data manipulation</span>
<a name="line-17"></a>    <span class='hs-comment'>-- | This package works with 2D ('Matrix') and 1D ('Vector')</span>
<a name="line-18"></a>    <span class='hs-comment'>-- arrays of real ('R') or complex ('C') double precision numbers.</span>
<a name="line-19"></a>    <span class='hs-comment'>-- Single precision and machine integers are also supported for</span>
<a name="line-20"></a>    <span class='hs-comment'>-- basic arithmetic and data manipulation.</span>
<a name="line-21"></a>    <span class='hs-keyword'>module</span> <span class='hs-conid'>Numeric</span><span class='hs-varop'>.</span><span class='hs-conid'>LinearAlgebra</span><span class='hs-varop'>.</span><span class='hs-conid'>Data</span><span class='hs-layout'>,</span>
<a name="line-22"></a>
<a name="line-23"></a>    <span class='hs-comment'>-- * Numeric classes</span>
<a name="line-24"></a>    <span class='hs-comment'>-- |</span>
<a name="line-25"></a>    <span class='hs-comment'>-- The standard numeric classes are defined elementwise (commonly referred to</span>
<a name="line-26"></a>    <span class='hs-comment'>-- as the Hadamard product or the Schur product):</span>
<a name="line-27"></a>    <span class='hs-comment'>--</span>
<a name="line-28"></a>    <span class='hs-comment'>-- &gt;&gt;&gt;  vector [1,2,3] * vector [3,0,-2]</span>
<a name="line-29"></a>    <span class='hs-comment'>-- fromList [3.0,0.0,-6.0]</span>
<a name="line-30"></a>    <span class='hs-comment'>--</span>
<a name="line-31"></a>    <span class='hs-comment'>-- &gt;&gt;&gt; matrix 3 [1..9] * ident 3</span>
<a name="line-32"></a>    <span class='hs-comment'>-- (3&gt;&lt;3)</span>
<a name="line-33"></a>    <span class='hs-comment'>--  [ 1.0, 0.0, 0.0</span>
<a name="line-34"></a>    <span class='hs-comment'>--  , 0.0, 5.0, 0.0</span>
<a name="line-35"></a>    <span class='hs-comment'>--  , 0.0, 0.0, 9.0 ]</span>
<a name="line-36"></a>
<a name="line-37"></a>    <span class='hs-comment'>-- * Autoconformable dimensions</span>
<a name="line-38"></a>    <span class='hs-comment'>-- |</span>
<a name="line-39"></a>    <span class='hs-comment'>-- In most operations, single-element vectors and matrices</span>
<a name="line-40"></a>    <span class='hs-comment'>-- (created from numeric literals or using 'scalar'), and matrices</span>
<a name="line-41"></a>    <span class='hs-comment'>-- with just one row or column, automatically</span>
<a name="line-42"></a>    <span class='hs-comment'>-- expand to match the dimensions of the other operand:</span>
<a name="line-43"></a>    <span class='hs-comment'>--</span>
<a name="line-44"></a>    <span class='hs-comment'>-- &gt;&gt;&gt; 5 + 2*ident 3 :: Matrix Double</span>
<a name="line-45"></a>    <span class='hs-comment'>-- (3&gt;&lt;3)</span>
<a name="line-46"></a>    <span class='hs-comment'>--  [ 7.0, 5.0, 5.0</span>
<a name="line-47"></a>    <span class='hs-comment'>--  , 5.0, 7.0, 5.0</span>
<a name="line-48"></a>    <span class='hs-comment'>--  , 5.0, 5.0, 7.0 ]</span>
<a name="line-49"></a>    <span class='hs-comment'>--</span>
<a name="line-50"></a>    <span class='hs-comment'>-- &gt;&gt;&gt; (4&gt;&lt;3) [1..] + row [10,20,30]</span>
<a name="line-51"></a>    <span class='hs-comment'>-- (4&gt;&lt;3)</span>
<a name="line-52"></a>    <span class='hs-comment'>--  [ 11.0, 22.0, 33.0</span>
<a name="line-53"></a>    <span class='hs-comment'>--  , 14.0, 25.0, 36.0</span>
<a name="line-54"></a>    <span class='hs-comment'>--  , 17.0, 28.0, 39.0</span>
<a name="line-55"></a>    <span class='hs-comment'>--  , 20.0, 31.0, 42.0 ]</span>
<a name="line-56"></a>    <span class='hs-comment'>--</span>
<a name="line-57"></a>
<a name="line-58"></a>    <span class='hs-comment'>-- * Products</span>
<a name="line-59"></a>    <span class='hs-comment'>-- ** Dot</span>
<a name="line-60"></a>    <span class='hs-varid'>dot</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;.&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-61"></a>    <span class='hs-comment'>-- ** Matrix-vector</span>
<a name="line-62"></a>    <span class='hs-layout'>(</span><span class='hs-cpp'>#&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>!#&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-63"></a>    <span class='hs-comment'>-- ** Matrix-matrix</span>
<a name="line-64"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>&lt;&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-65"></a>    <span class='hs-comment'>-- | The matrix product is also implemented in the "Data.Monoid" instance, where</span>
<a name="line-66"></a>    <span class='hs-comment'>-- single-element matrices (created from numeric literals or using 'scalar')</span>
<a name="line-67"></a>    <span class='hs-comment'>-- are used for scaling.</span>
<a name="line-68"></a>    <span class='hs-comment'>--</span>
<a name="line-69"></a>    <span class='hs-comment'>-- &gt;&gt;&gt; import Data.Monoid as M</span>
<a name="line-70"></a>    <span class='hs-comment'>-- &gt;&gt;&gt;  let m = matrix 3 [1..6]</span>
<a name="line-71"></a>    <span class='hs-comment'>-- &gt;&gt;&gt; m M.&lt;&gt; 2 M.&lt;&gt; diagl[0.5,1,0]</span>
<a name="line-72"></a>    <span class='hs-comment'>-- (2&gt;&lt;3)</span>
<a name="line-73"></a>    <span class='hs-comment'>--  [ 1.0,  4.0, 0.0</span>
<a name="line-74"></a>    <span class='hs-comment'>--  , 4.0, 10.0, 0.0 ]</span>
<a name="line-75"></a>    <span class='hs-comment'>--</span>
<a name="line-76"></a>    <span class='hs-comment'>-- 'mconcat' uses 'optimiseMult' to get the optimal association order.</span>
<a name="line-77"></a>
<a name="line-78"></a>
<a name="line-79"></a>    <span class='hs-comment'>-- ** Other</span>
<a name="line-80"></a>    <span class='hs-varid'>outer</span><span class='hs-layout'>,</span> <span class='hs-varid'>kronecker</span><span class='hs-layout'>,</span> <span class='hs-varid'>cross</span><span class='hs-layout'>,</span>
<a name="line-81"></a>    <span class='hs-varid'>scale</span><span class='hs-layout'>,</span> <span class='hs-varid'>add</span><span class='hs-layout'>,</span>
<a name="line-82"></a>    <span class='hs-varid'>sumElements</span><span class='hs-layout'>,</span> <span class='hs-varid'>prodElements</span><span class='hs-layout'>,</span>
<a name="line-83"></a>
<a name="line-84"></a>    <span class='hs-comment'>-- * Linear systems</span>
<a name="line-85"></a>    <span class='hs-comment'>-- ** General</span>
<a name="line-86"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>&lt;\&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-87"></a>    <span class='hs-varid'>linearSolveLS</span><span class='hs-layout'>,</span>
<a name="line-88"></a>    <span class='hs-varid'>linearSolveSVD</span><span class='hs-layout'>,</span>
<a name="line-89"></a>    <span class='hs-comment'>-- ** Determined</span>
<a name="line-90"></a>    <span class='hs-varid'>linearSolve</span><span class='hs-layout'>,</span>
<a name="line-91"></a>    <span class='hs-varid'>luSolve</span><span class='hs-layout'>,</span> <span class='hs-varid'>luPacked</span><span class='hs-layout'>,</span>
<a name="line-92"></a>    <span class='hs-varid'>luSolve'</span><span class='hs-layout'>,</span> <span class='hs-varid'>luPacked'</span><span class='hs-layout'>,</span>
<a name="line-93"></a>    <span class='hs-comment'>-- ** Symmetric indefinite</span>
<a name="line-94"></a>    <span class='hs-varid'>ldlSolve</span><span class='hs-layout'>,</span> <span class='hs-varid'>ldlPacked</span><span class='hs-layout'>,</span>
<a name="line-95"></a>    <span class='hs-comment'>-- ** Positive definite</span>
<a name="line-96"></a>    <span class='hs-varid'>cholSolve</span><span class='hs-layout'>,</span>
<a name="line-97"></a>    <span class='hs-comment'>-- ** Sparse</span>
<a name="line-98"></a>    <span class='hs-varid'>cgSolve</span><span class='hs-layout'>,</span>
<a name="line-99"></a>    <span class='hs-varid'>cgSolve'</span><span class='hs-layout'>,</span>
<a name="line-100"></a>
<a name="line-101"></a>    <span class='hs-comment'>-- * Inverse and pseudoinverse</span>
<a name="line-102"></a>    <span class='hs-varid'>inv</span><span class='hs-layout'>,</span> <span class='hs-varid'>pinv</span><span class='hs-layout'>,</span> <span class='hs-varid'>pinvTol</span><span class='hs-layout'>,</span>
<a name="line-103"></a>
<a name="line-104"></a>    <span class='hs-comment'>-- * Determinant and rank</span>
<a name="line-105"></a>    <span class='hs-varid'>rcond</span><span class='hs-layout'>,</span> <span class='hs-varid'>rank</span><span class='hs-layout'>,</span>
<a name="line-106"></a>    <span class='hs-varid'>det</span><span class='hs-layout'>,</span> <span class='hs-varid'>invlndet</span><span class='hs-layout'>,</span>
<a name="line-107"></a>
<a name="line-108"></a>    <span class='hs-comment'>-- * Norms</span>
<a name="line-109"></a>    <span class='hs-conid'>Normed</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-110"></a>    <span class='hs-varid'>norm_Frob</span><span class='hs-layout'>,</span> <span class='hs-varid'>norm_nuclear</span><span class='hs-layout'>,</span>
<a name="line-111"></a>
<a name="line-112"></a>    <span class='hs-comment'>-- * Nullspace and range</span>
<a name="line-113"></a>    <span class='hs-varid'>orth</span><span class='hs-layout'>,</span>
<a name="line-114"></a>    <span class='hs-varid'>nullspace</span><span class='hs-layout'>,</span> <span class='hs-varid'>null1</span><span class='hs-layout'>,</span> <span class='hs-varid'>null1sym</span><span class='hs-layout'>,</span>
<a name="line-115"></a>
<a name="line-116"></a>    <span class='hs-comment'>-- * Singular value decomposition</span>
<a name="line-117"></a>    <span class='hs-varid'>svd</span><span class='hs-layout'>,</span>
<a name="line-118"></a>    <span class='hs-varid'>thinSVD</span><span class='hs-layout'>,</span>
<a name="line-119"></a>    <span class='hs-varid'>compactSVD</span><span class='hs-layout'>,</span>
<a name="line-120"></a>    <span class='hs-varid'>singularValues</span><span class='hs-layout'>,</span>
<a name="line-121"></a>    <span class='hs-varid'>leftSV</span><span class='hs-layout'>,</span> <span class='hs-varid'>rightSV</span><span class='hs-layout'>,</span>
<a name="line-122"></a>
<a name="line-123"></a>    <span class='hs-comment'>-- * Eigendecomposition</span>
<a name="line-124"></a>    <span class='hs-varid'>eig</span><span class='hs-layout'>,</span> <span class='hs-varid'>eigSH</span><span class='hs-layout'>,</span>
<a name="line-125"></a>    <span class='hs-varid'>eigenvalues</span><span class='hs-layout'>,</span> <span class='hs-varid'>eigenvaluesSH</span><span class='hs-layout'>,</span>
<a name="line-126"></a>    <span class='hs-varid'>geigSH</span><span class='hs-layout'>,</span>
<a name="line-127"></a>
<a name="line-128"></a>    <span class='hs-comment'>-- * QR</span>
<a name="line-129"></a>    <span class='hs-varid'>qr</span><span class='hs-layout'>,</span> <span class='hs-varid'>rq</span><span class='hs-layout'>,</span> <span class='hs-varid'>qrRaw</span><span class='hs-layout'>,</span> <span class='hs-varid'>qrgr</span><span class='hs-layout'>,</span>
<a name="line-130"></a>
<a name="line-131"></a>    <span class='hs-comment'>-- * Cholesky</span>
<a name="line-132"></a>    <span class='hs-varid'>chol</span><span class='hs-layout'>,</span> <span class='hs-varid'>mbChol</span><span class='hs-layout'>,</span>
<a name="line-133"></a>
<a name="line-134"></a>    <span class='hs-comment'>-- * LU</span>
<a name="line-135"></a>    <span class='hs-varid'>lu</span><span class='hs-layout'>,</span> <span class='hs-varid'>luFact</span><span class='hs-layout'>,</span>
<a name="line-136"></a>
<a name="line-137"></a>    <span class='hs-comment'>-- * Hessenberg</span>
<a name="line-138"></a>    <span class='hs-varid'>hess</span><span class='hs-layout'>,</span>
<a name="line-139"></a>
<a name="line-140"></a>    <span class='hs-comment'>-- * Schur</span>
<a name="line-141"></a>    <span class='hs-varid'>schur</span><span class='hs-layout'>,</span>
<a name="line-142"></a>
<a name="line-143"></a>    <span class='hs-comment'>-- * Matrix functions</span>
<a name="line-144"></a>    <span class='hs-varid'>expm</span><span class='hs-layout'>,</span>
<a name="line-145"></a>    <span class='hs-varid'>sqrtm</span><span class='hs-layout'>,</span>
<a name="line-146"></a>    <span class='hs-varid'>matFunc</span><span class='hs-layout'>,</span>
<a name="line-147"></a>
<a name="line-148"></a>    <span class='hs-comment'>-- * Correlation and convolution</span>
<a name="line-149"></a>    <span class='hs-varid'>corr</span><span class='hs-layout'>,</span> <span class='hs-varid'>conv</span><span class='hs-layout'>,</span> <span class='hs-varid'>corrMin</span><span class='hs-layout'>,</span> <span class='hs-varid'>corr2</span><span class='hs-layout'>,</span> <span class='hs-varid'>conv2</span><span class='hs-layout'>,</span>
<a name="line-150"></a>
<a name="line-151"></a>    <span class='hs-comment'>-- * Random arrays</span>
<a name="line-152"></a>
<a name="line-153"></a>    <span class='hs-conid'>Seed</span><span class='hs-layout'>,</span> <span class='hs-conid'>RandDist</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>randomVector</span><span class='hs-layout'>,</span> <span class='hs-varid'>rand</span><span class='hs-layout'>,</span> <span class='hs-varid'>randn</span><span class='hs-layout'>,</span> <span class='hs-varid'>gaussianSample</span><span class='hs-layout'>,</span> <span class='hs-varid'>uniformSample</span><span class='hs-layout'>,</span>
<a name="line-154"></a>
<a name="line-155"></a>    <span class='hs-comment'>-- * Misc</span>
<a name="line-156"></a>    <span class='hs-varid'>meanCov</span><span class='hs-layout'>,</span> <span class='hs-varid'>rowOuters</span><span class='hs-layout'>,</span> <span class='hs-varid'>pairwiseD2</span><span class='hs-layout'>,</span> <span class='hs-varid'>unitary</span><span class='hs-layout'>,</span> <span class='hs-varid'>peps</span><span class='hs-layout'>,</span> <span class='hs-varid'>relativeError</span><span class='hs-layout'>,</span> <span class='hs-varid'>magnit</span><span class='hs-layout'>,</span>
<a name="line-157"></a>    <span class='hs-varid'>haussholder</span><span class='hs-layout'>,</span> <span class='hs-varid'>optimiseMult</span><span class='hs-layout'>,</span> <span class='hs-varid'>udot</span><span class='hs-layout'>,</span> <span class='hs-varid'>nullspaceSVD</span><span class='hs-layout'>,</span> <span class='hs-varid'>orthSVD</span><span class='hs-layout'>,</span> <span class='hs-varid'>ranksv</span><span class='hs-layout'>,</span>
<a name="line-158"></a>    <span class='hs-varid'>iC</span><span class='hs-layout'>,</span> <span class='hs-varid'>sym</span><span class='hs-layout'>,</span> <span class='hs-varid'>mTm</span><span class='hs-layout'>,</span> <span class='hs-varid'>trustSym</span><span class='hs-layout'>,</span> <span class='hs-varid'>unSym</span><span class='hs-layout'>,</span>
<a name="line-159"></a>    <span class='hs-comment'>-- * Auxiliary classes</span>
<a name="line-160"></a>    <span class='hs-conid'>Element</span><span class='hs-layout'>,</span> <span class='hs-conid'>Container</span><span class='hs-layout'>,</span> <span class='hs-conid'>Product</span><span class='hs-layout'>,</span> <span class='hs-conid'>Numeric</span><span class='hs-layout'>,</span> <span class='hs-conid'>LSDiv</span><span class='hs-layout'>,</span> <span class='hs-conid'>Herm</span><span class='hs-layout'>,</span>
<a name="line-161"></a>    <span class='hs-conid'>Complexable</span><span class='hs-layout'>,</span> <span class='hs-conid'>RealElement</span><span class='hs-layout'>,</span>
<a name="line-162"></a>    <span class='hs-conid'>RealOf</span><span class='hs-layout'>,</span> <span class='hs-conid'>ComplexOf</span><span class='hs-layout'>,</span> <span class='hs-conid'>SingleOf</span><span class='hs-layout'>,</span> <span class='hs-conid'>DoubleOf</span><span class='hs-layout'>,</span>
<a name="line-163"></a>    <span class='hs-conid'>IndexOf</span><span class='hs-layout'>,</span>
<a name="line-164"></a>    <span class='hs-conid'>Field</span><span class='hs-layout'>,</span> <span class='hs-conid'>Linear</span><span class='hs-conid'>()</span><span class='hs-layout'>,</span> <span class='hs-conid'>Additive</span><span class='hs-conid'>()</span><span class='hs-layout'>,</span>
<a name="line-165"></a>    <span class='hs-conid'>Transposable</span><span class='hs-layout'>,</span>
<a name="line-166"></a>    <span class='hs-conid'>LU</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-167"></a>    <span class='hs-conid'>LDL</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-168"></a>    <span class='hs-conid'>QR</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-169"></a>    <span class='hs-conid'>CGState</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-170"></a>    <span class='hs-conid'>Testable</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span>
<a name="line-171"></a><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-172"></a>
<a name="line-173"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Numeric</span><span class='hs-varop'>.</span><span class='hs-conid'>LinearAlgebra</span><span class='hs-varop'>.</span><span class='hs-conid'>Data</span>
<a name="line-174"></a>
<a name="line-175"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Numeric</span><span class='hs-varop'>.</span><span class='hs-conid'>Matrix</span><span class='hs-conid'>()</span>
<a name="line-176"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Numeric</span><span class='hs-varop'>.</span><span class='hs-conid'>Vector</span><span class='hs-conid'>()</span>
<a name="line-177"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Internal</span><span class='hs-varop'>.</span><span class='hs-conid'>Matrix</span>
<a name="line-178"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Internal</span><span class='hs-varop'>.</span><span class='hs-conid'>Container</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>&lt;&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-179"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Internal</span><span class='hs-varop'>.</span><span class='hs-conid'>Numeric</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>mul</span><span class='hs-layout'>)</span>
<a name="line-180"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Internal</span><span class='hs-varop'>.</span><span class='hs-conid'>Algorithms</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>linearSolve</span><span class='hs-layout'>,</span><span class='hs-conid'>Normed</span><span class='hs-layout'>,</span><span class='hs-varid'>orth</span><span class='hs-layout'>,</span><span class='hs-varid'>luPacked'</span><span class='hs-layout'>,</span><span class='hs-varid'>linearSolve'</span><span class='hs-layout'>,</span><span class='hs-varid'>luSolve'</span><span class='hs-layout'>,</span><span class='hs-varid'>ldlPacked'</span><span class='hs-layout'>)</span>
<a name="line-181"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Internal</span><span class='hs-varop'>.</span><span class='hs-conid'>Algorithms</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>A</span>
<a name="line-182"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Internal</span><span class='hs-varop'>.</span><span class='hs-conid'>Util</span>
<a name="line-183"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Internal</span><span class='hs-varop'>.</span><span class='hs-conid'>Random</span>
<a name="line-184"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Internal</span><span class='hs-varop'>.</span><span class='hs-conid'>Sparse</span><span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>!#&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-185"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Internal</span><span class='hs-varop'>.</span><span class='hs-conid'>CG</span>
<a name="line-186"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Internal</span><span class='hs-varop'>.</span><span class='hs-conid'>Conversion</span>
<a name="line-187"></a>
<a name="line-188"></a><a name="%3c%3e"></a><span class='hs-comment'>{- | dense matrix product
<a name="line-189"></a>
<a name="line-190"></a>&gt;&gt;&gt; let a = (3&gt;&lt;5) [1..]
<a name="line-191"></a>&gt;&gt;&gt; a
<a name="line-192"></a>(3&gt;&lt;5)
<a name="line-193"></a> [  1.0,  2.0,  3.0,  4.0,  5.0
<a name="line-194"></a> ,  6.0,  7.0,  8.0,  9.0, 10.0
<a name="line-195"></a> , 11.0, 12.0, 13.0, 14.0, 15.0 ]
<a name="line-196"></a>
<a name="line-197"></a>&gt;&gt;&gt; let b = (5&gt;&lt;2) [1,3, 0,2, -1,5, 7,7, 6,0]
<a name="line-198"></a>&gt;&gt;&gt; b
<a name="line-199"></a>(5&gt;&lt;2)
<a name="line-200"></a> [  1.0, 3.0
<a name="line-201"></a> ,  0.0, 2.0
<a name="line-202"></a> , -1.0, 5.0
<a name="line-203"></a> ,  7.0, 7.0
<a name="line-204"></a> ,  6.0, 0.0 ]
<a name="line-205"></a>
<a name="line-206"></a>&gt;&gt;&gt; a &lt;&gt; b
<a name="line-207"></a>(3&gt;&lt;2)
<a name="line-208"></a> [  56.0,  50.0
<a name="line-209"></a> , 121.0, 135.0
<a name="line-210"></a> , 186.0, 220.0 ]
<a name="line-211"></a>
<a name="line-212"></a>-}</span>
<a name="line-213"></a><span class='hs-layout'>(</span><span class='hs-varop'>&lt;&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Numeric</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>t</span>
<a name="line-214"></a><span class='hs-layout'>(</span><span class='hs-varop'>&lt;&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mXm</span>
<a name="line-215"></a><span class='hs-keyword'>infixr</span> <span class='hs-num'>8</span> <span class='hs-varop'>&lt;&gt;</span>
<a name="line-216"></a>
<a name="line-217"></a>
<a name="line-218"></a><a name="linearSolve"></a><span class='hs-comment'>{- | Solve a linear system (for square coefficient matrix and several right-hand sides) using the LU decomposition, returning Nothing for a singular system. For underconstrained or overconstrained systems use 'linearSolveLS' or 'linearSolveSVD'.
<a name="line-219"></a>
<a name="line-220"></a>@
<a name="line-221"></a>a = (2&gt;&lt;2)
<a name="line-222"></a> [ 1.0, 2.0
<a name="line-223"></a> , 3.0, 5.0 ]
<a name="line-224"></a>@
<a name="line-225"></a>
<a name="line-226"></a>@
<a name="line-227"></a>b = (2&gt;&lt;3)
<a name="line-228"></a> [  6.0, 1.0, 10.0
<a name="line-229"></a> , 15.0, 3.0, 26.0 ]
<a name="line-230"></a>@
<a name="line-231"></a>
<a name="line-232"></a>&gt;&gt;&gt; linearSolve a b
<a name="line-233"></a>Just (2&gt;&lt;3)
<a name="line-234"></a> [ -1.4802973661668753e-15,     0.9999999999999997, 1.999999999999997
<a name="line-235"></a> ,       3.000000000000001, 1.6653345369377348e-16, 4.000000000000002 ]
<a name="line-236"></a>
<a name="line-237"></a>&gt;&gt;&gt; let Just x = it
<a name="line-238"></a>&gt;&gt;&gt; disp 5 x
<a name="line-239"></a>2x3
<a name="line-240"></a>-0.00000  1.00000  2.00000
<a name="line-241"></a> 3.00000  0.00000  4.00000
<a name="line-242"></a>
<a name="line-243"></a>&gt;&gt;&gt; a &lt;&gt; x
<a name="line-244"></a>(2&gt;&lt;3)
<a name="line-245"></a> [  6.0, 1.0, 10.0
<a name="line-246"></a> , 15.0, 3.0, 26.0 ]
<a name="line-247"></a>
<a name="line-248"></a>-}</span>
<a name="line-249"></a><span class='hs-definition'>linearSolve</span> <span class='hs-varid'>m</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>A</span><span class='hs-varop'>.</span><span class='hs-varid'>mbLinearSolve</span> <span class='hs-varid'>m</span> <span class='hs-varid'>b</span>
<a name="line-250"></a>
<a name="line-251"></a><a name="nullspace"></a><span class='hs-comment'>-- | return an orthonormal basis of the null space of a matrix. See also 'nullspaceSVD'.</span>
<a name="line-252"></a><span class='hs-definition'>nullspace</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>nullspaceSVD</span> <span class='hs-layout'>(</span><span class='hs-conid'>Left</span> <span class='hs-layout'>(</span><span class='hs-num'>1</span><span class='hs-varop'>*</span><span class='hs-varid'>eps</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>rightSV</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span>
<a name="line-253"></a>
<a name="line-254"></a><a name="orth"></a><span class='hs-comment'>-- | return an orthonormal basis of the range space of a matrix. See also 'orthSVD'.</span>
<a name="line-255"></a><span class='hs-definition'>orth</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>orthSVD</span> <span class='hs-layout'>(</span><span class='hs-conid'>Left</span> <span class='hs-layout'>(</span><span class='hs-num'>1</span><span class='hs-varop'>*</span><span class='hs-varid'>eps</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>leftSV</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span>
<a name="line-256"></a>
</pre></body>
</html>
